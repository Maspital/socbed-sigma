[
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:56:09.434Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.077Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs",
                    "name": "Windows PowerShell",
                    "path": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:56:09.434\nProcessGuid: {0e37ca90-ec32-6343-1200-000000000300}\nProcessId: 356\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\nCreationUtcTime: 2022-10-10 09:56:09.434\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ec32-6343-1200-000000000300}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 356
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:56:09.434",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 563,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:56:09.434+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:56:09.469Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.077Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{b233f924-1acf-4cd9-97d7-feeb8be5e7fa}.tmp",
                    "path": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{b233f924-1acf-4cd9-97d7-feeb8be5e7fa}.tmp"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:56:09.469\nProcessGuid: {0e37ca90-ec32-6343-1200-000000000300}\nProcessId: 356\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{b233f924-1acf-4cd9-97d7-feeb8be5e7fa}.tmp\nCreationUtcTime: 2022-10-10 09:56:09.469\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ec32-6343-1200-000000000300}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 356
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:56:09.469",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 572,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:56:09.469+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:56:09.469Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.077Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{cda0f5bf-0af2-4b8b-90f6-02d275b810d4}.tmp",
                    "path": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{cda0f5bf-0af2-4b8b-90f6-02d275b810d4}.tmp"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:56:09.469\nProcessGuid: {0e37ca90-ec32-6343-1200-000000000300}\nProcessId: 356\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{cda0f5bf-0af2-4b8b-90f6-02d275b810d4}.tmp\nCreationUtcTime: 2022-10-10 09:56:09.469\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ec32-6343-1200-000000000300}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 356
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:56:09.469",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 571,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:56:09.469+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:56:09.469Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.077Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{cda0f5bf-0af2-4b8b-90f6-02d275b810d4}.tmp",
                    "path": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{cda0f5bf-0af2-4b8b-90f6-02d275b810d4}.tmp"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:56:09.469\nProcessGuid: {0e37ca90-ec32-6343-1200-000000000300}\nProcessId: 356\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{cda0f5bf-0af2-4b8b-90f6-02d275b810d4}.tmp\nCreationUtcTime: 2022-10-10 09:56:09.469\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ec32-6343-1200-000000000300}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 356
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:56:09.469",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 570,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:56:09.469+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:56:09.469Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.077Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{b233f924-1acf-4cd9-97d7-feeb8be5e7fa}.tmp",
                    "path": "C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{b233f924-1acf-4cd9-97d7-feeb8be5e7fa}.tmp"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:56:09.469\nProcessGuid: {0e37ca90-ec32-6343-1200-000000000300}\nProcessId: 356\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\setup\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{b233f924-1acf-4cd9-97d7-feeb8be5e7fa}.tmp\nCreationUtcTime: 2022-10-10 09:56:09.469\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ec32-6343-1200-000000000300}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 356
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:56:09.469",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 573,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:56:09.469+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:57:09.360Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.373Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\setup\\AppData\\Local\\Microsoft\\CLR_v4.0\\UsageLogs",
                    "extension": "log",
                    "name": "powershell.exe.log",
                    "path": "C:\\Users\\setup\\AppData\\Local\\Microsoft\\CLR_v4.0\\UsageLogs\\powershell.exe.log"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: ProcessHostingdotNETCode\nUtcTime: 2022-10-10 09:57:09.360\nProcessGuid: {0e37ca90-ec74-6343-af00-000000000300}\nProcessId: 6520\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nTargetFilename: C:\\Users\\setup\\AppData\\Local\\Microsoft\\CLR_v4.0\\UsageLogs\\powershell.exe.log\nCreationUtcTime: 2022-10-10 09:57:09.360\nUser: CLIENT\\setup",
                "process": {
                    "entity_id": "{0e37ca90-ec74-6343-af00-000000000300}",
                    "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "name": "powershell.exe",
                    "pid": 6520
                },
                "rule": {
                    "name": "ProcessHostingdotNETCode"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:57:09.360",
                        "User": "CLIENT\\setup"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 814,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:57:09.360+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:57:51.738Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Pipeline Execution Details",
                    "category": [
                        "process"
                    ],
                    "code": 800,
                    "created": "2022-10-10T10:00:26.693Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 15,
                    "type": [
                        "info"
                    ]
                },
                "file": {
                    "directory": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US",
                    "extension": "psd1",
                    "name": "BitLocker.psd1",
                    "path": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1"
                },
                "host": {
                    "name": "CLIENT1"
                },
                "log": {
                    "level": "information"
                },
                "message": "Pipeline execution details for command line: ConvertFrom-StringData -stringdata @' \n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=15\n\n\tUserId=CLIENT1\\setup\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=5a4c00e4-9e12-44d8-b381-e05e1c79ca23\n\tHostApplication=powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=e3b8844b-d92a-4a0e-817f-c6291b380c70\n\tPipelineId=6\n\tScriptName=C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1\n\tCommandLine=ConvertFrom-StringData -stringdata @' \n \n\nDetails: \nCommandInvocation(ConvertFrom-StringData): \"ConvertFrom-StringData\"\nParameterBinding(ConvertFrom-StringData): name=\"StringData\"; value=\"###PSLOC\nErrorMountPointNotFound={0} does not have an associated BitLocker volume.\nErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume.\nErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume.\nErrorOperatingSystemMountPointNotFound=An operating system volume could not be found.\nWarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly.\nErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM.\nWarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.\nWarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningHardwareTestFailed=ERROR: The hardware test failed with code 0xConvertFrom-StringData -stringdata @' \n!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}\nWarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nWarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery.\nErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in.\nErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller.\nPasswordPrompt=Enter Password:\nConfirmPasswordPrompt=Confirm Password:\nNoMatchPassword=These passwords do not match. Please re-enter them.\nPinPrompt=Enter Pin:\nConfirmPinPrompt=Confirm Pin:\nNoMatchPin=These pins do not match. Please re-enter them.\nErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\"",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "ConvertFrom-StringData",
                                "type": "CommandInvocation",
                                "value": "\"ConvertFrom-StringData\""
                            },
                            {
                                "name": "\"StringData\"",
                                "related_command": "ConvertFrom-StringData",
                                "type": "ParameterBinding",
                                "value": "\"###PSLOC"
                            },
                            {
                                "value": "ErrorMountPointNotFound={0} does not have an associated BitLocker volume."
                            },
                            {
                                "value": "ErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume."
                            },
                            {
                                "value": "ErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume."
                            },
                            {
                                "value": "ErrorOperatingSystemMountPointNotFound=An operating system volume could not be found."
                            },
                            {
                                "value": "WarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly."
                            },
                            {
                                "value": "ErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningHardwareTestFailed=ERROR: The hardware test failed with code 0x%1!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}"
                            },
                            {
                                "value": "WarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "ErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery."
                            },
                            {
                                "value": "ErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in."
                            },
                            {
                                "value": "ErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller."
                            },
                            {
                                "value": "PasswordPrompt=Enter Password:"
                            },
                            {
                                "value": "ConfirmPasswordPrompt=Confirm Password:"
                            },
                            {
                                "value": "NoMatchPassword=These passwords do not match. Please re-enter them."
                            },
                            {
                                "value": "PinPrompt=Enter Pin:"
                            },
                            {
                                "value": "ConfirmPinPrompt=Confirm Pin:"
                            },
                            {
                                "value": "NoMatchPin=These pins do not match. Please re-enter them."
                            },
                            {
                                "value": "ErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\""
                            }
                        ],
                        "value": "ConvertFrom-StringData -stringdata @'"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "pipeline_id": "6",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "e3b8844b-d92a-4a0e-817f-c6291b380c70",
                    "sequence": 1,
                    "total": 1
                },
                "process": {
                    "args": [
                        "powershell",
                        "$admin_secpwd",
                        "=",
                        "ConvertTo-SecureString",
                        "'breach'",
                        "-AsPlainText",
                        "-Force;",
                        "$credential",
                        "=",
                        "New-Object",
                        "-TypeName",
                        "System.Management.Automation.PSCredential",
                        "-ArgumentList",
                        "'BREACH\\Administrator',",
                        "$admin_secpwd;",
                        "Add-Computer",
                        "-Credential",
                        "$credential",
                        "-DomainName",
                        "'BREACH'",
                        "-Restart",
                        "-Force"
                    ],
                    "args_count": 22,
                    "command_line": "powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force",
                    "entity_id": "5a4c00e4-9e12-44d8-b381-e05e1c79ca23",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "setup"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "setup"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1",
                    "event_id": 800,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6581,
                    "task": "Pipeline Execution Details"
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:57:51.738+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:57:51.746Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Executing Pipeline",
                    "category": [
                        "process"
                    ],
                    "code": 4103,
                    "created": "2022-10-10T10:00:26.611Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "Microsoft-Windows-PowerShell",
                    "sequence": 16,
                    "type": [
                        "info"
                    ]
                },
                "file": {
                    "directory": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US",
                    "extension": "psd1",
                    "name": "BitLocker.psd1",
                    "path": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1"
                },
                "host": {
                    "name": "CLIENT1"
                },
                "log": {
                    "level": "information"
                },
                "message": "CommandInvocation(ConvertFrom-StringData): \"ConvertFrom-StringData\"\nParameterBinding(ConvertFrom-StringData): name=\"StringData\"; value=\"###PSLOC\nErrorMountPointNotFound={0} does not have an associated BitLocker volume.\nErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume.\nErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume.\nErrorOperatingSystemMountPointNotFound=An operating system volume could not be found.\nWarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly.\nErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM.\nWarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.\nWarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningHardwareTestFailed=ERROR: The hardware test failed with code 0x        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = 5a4c00e4-9e12-44d8-b381-e05e1c79ca23\n        Host Application = powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force\n        Engine Version = 5.1.19041.1237\n        Runspace ID = e3b8844b-d92a-4a0e-817f-c6291b380c70\n        Pipeline ID = 6\n        Command Name = ConvertFrom-StringData\n        Command Type = Cmdlet\n        Script Name = C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1\n        Command Path = \n        Sequence Number = 16\n        User = CLIENT1\\setup\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}\nWarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nWarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery.\nErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in.\nErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller.\nPasswordPrompt=Enter Password:\nConfirmPasswordPrompt=Confirm Password:\nNoMatchPassword=These passwords do not match. Please re-enter them.\nPinPrompt=Enter Pin:\nConfirmPinPrompt=Confirm Pin:\nNoMatchPin=These pins do not match. Please re-enter them.\nErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = 5a4c00e4-9e12-44d8-b381-e05e1c79ca23\n        Host Application = powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force\n        Engine Version = 5.1.19041.1237\n        Runspace ID = e3b8844b-d92a-4a0e-817f-c6291b380c70\n        Pipeline ID = 6\n        Command Name = ConvertFrom-StringData\n        Command Type = Cmdlet\n        Script Name = C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1\n        Command Path = \n        Sequence Number = 16\n        User = CLIENT1\\setup\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "ConvertFrom-StringData",
                                "type": "CommandInvocation",
                                "value": "\"ConvertFrom-StringData\""
                            },
                            {
                                "name": "\"StringData\"",
                                "related_command": "ConvertFrom-StringData",
                                "type": "ParameterBinding",
                                "value": "\"###PSLOC"
                            },
                            {
                                "value": "ErrorMountPointNotFound={0} does not have an associated BitLocker volume."
                            },
                            {
                                "value": "ErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume."
                            },
                            {
                                "value": "ErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume."
                            },
                            {
                                "value": "ErrorOperatingSystemMountPointNotFound=An operating system volume could not be found."
                            },
                            {
                                "value": "WarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly."
                            },
                            {
                                "value": "ErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningHardwareTestFailed=ERROR: The hardware test failed with code 0x%1!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}"
                            },
                            {
                                "value": "WarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "ErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery."
                            },
                            {
                                "value": "ErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in."
                            },
                            {
                                "value": "ErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller."
                            },
                            {
                                "value": "PasswordPrompt=Enter Password:"
                            },
                            {
                                "value": "ConfirmPasswordPrompt=Confirm Password:"
                            },
                            {
                                "value": "NoMatchPassword=These passwords do not match. Please re-enter them."
                            },
                            {
                                "value": "PinPrompt=Enter Pin:"
                            },
                            {
                                "value": "ConfirmPinPrompt=Confirm Pin:"
                            },
                            {
                                "value": "NoMatchPin=These pins do not match. Please re-enter them."
                            },
                            {
                                "value": "ErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\""
                            }
                        ],
                        "name": "ConvertFrom-StringData",
                        "type": "Cmdlet"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "id": "Microsoft.PowerShell",
                    "pipeline_id": "6",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "e3b8844b-d92a-4a0e-817f-c6291b380c70"
                },
                "process": {
                    "args": [
                        "powershell",
                        "$admin_secpwd",
                        "=",
                        "ConvertTo-SecureString",
                        "'breach'",
                        "-AsPlainText",
                        "-Force;",
                        "$credential",
                        "=",
                        "New-Object",
                        "-TypeName",
                        "System.Management.Automation.PSCredential",
                        "-ArgumentList",
                        "'BREACH\\Administrator',",
                        "$admin_secpwd;",
                        "Add-Computer",
                        "-Credential",
                        "$credential",
                        "-DomainName",
                        "'BREACH'",
                        "-Restart",
                        "-Force"
                    ],
                    "args_count": 22,
                    "command_line": "powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force",
                    "entity_id": "5a4c00e4-9e12-44d8-b381-e05e1c79ca23",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "setup"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "setup"
                },
                "winlog": {
                    "activity_id": "{b0c2654b-dc8e-0000-d469-c2b08edcd801}",
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-PowerShell/Operational",
                    "computer_name": "CLIENT1",
                    "event_id": 4103,
                    "opcode": "To be used when operation is just executing a method",
                    "process": {
                        "pid": 4380,
                        "thread": {
                            "id": 4524
                        }
                    },
                    "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                    "provider_name": "Microsoft-Windows-PowerShell",
                    "record_id": 6046,
                    "task": "Executing Pipeline",
                    "user": {
                        "domain": "CLIENT1",
                        "identifier": "S-1-5-21-2755423373-3250654863-1302750906-1002",
                        "name": "setup",
                        "type": "User"
                    },
                    "version": 1
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:57:51.746+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:57:51.754Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Pipeline Execution Details",
                    "category": [
                        "process"
                    ],
                    "code": 800,
                    "created": "2022-10-10T10:00:26.694Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "PowerShell",
                    "sequence": 17,
                    "type": [
                        "info"
                    ]
                },
                "file": {
                    "directory": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US",
                    "extension": "psd1",
                    "name": "BitLocker.psd1",
                    "path": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1"
                },
                "host": {
                    "name": "CLIENT1"
                },
                "log": {
                    "level": "information"
                },
                "message": "Pipeline execution details for command line: ConvertFrom-StringData -stringdata @' \n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=17\n\n\tUserId=CLIENT1\\setup\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=5a4c00e4-9e12-44d8-b381-e05e1c79ca23\n\tHostApplication=powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=e3b8844b-d92a-4a0e-817f-c6291b380c70\n\tPipelineId=6\n\tScriptName=C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1\n\tCommandLine=ConvertFrom-StringData -stringdata @' \n \n\nDetails: \nCommandInvocation(ConvertFrom-StringData): \"ConvertFrom-StringData\"\nParameterBinding(ConvertFrom-StringData): name=\"StringData\"; value=\"###PSLOC\nErrorMountPointNotFound={0} does not have an associated BitLocker volume.\nErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume.\nErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume.\nErrorOperatingSystemMountPointNotFound=An operating system volume could not be found.\nWarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly.\nErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM.\nWarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.\nWarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningHardwareTestFailed=ERROR: The hardware test failed with code 0xConvertFrom-StringData -stringdata @' \n!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}\nWarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nWarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery.\nErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in.\nErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller.\nPasswordPrompt=Enter Password:\nConfirmPasswordPrompt=Confirm Password:\nNoMatchPassword=These passwords do not match. Please re-enter them.\nPinPrompt=Enter Pin:\nConfirmPinPrompt=Confirm Pin:\nNoMatchPin=These pins do not match. Please re-enter them.\nErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\"",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "ConvertFrom-StringData",
                                "type": "CommandInvocation",
                                "value": "\"ConvertFrom-StringData\""
                            },
                            {
                                "name": "\"StringData\"",
                                "related_command": "ConvertFrom-StringData",
                                "type": "ParameterBinding",
                                "value": "\"###PSLOC"
                            },
                            {
                                "value": "ErrorMountPointNotFound={0} does not have an associated BitLocker volume."
                            },
                            {
                                "value": "ErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume."
                            },
                            {
                                "value": "ErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume."
                            },
                            {
                                "value": "ErrorOperatingSystemMountPointNotFound=An operating system volume could not be found."
                            },
                            {
                                "value": "WarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly."
                            },
                            {
                                "value": "ErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningHardwareTestFailed=ERROR: The hardware test failed with code 0x%1!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}"
                            },
                            {
                                "value": "WarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "ErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery."
                            },
                            {
                                "value": "ErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in."
                            },
                            {
                                "value": "ErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller."
                            },
                            {
                                "value": "PasswordPrompt=Enter Password:"
                            },
                            {
                                "value": "ConfirmPasswordPrompt=Confirm Password:"
                            },
                            {
                                "value": "NoMatchPassword=These passwords do not match. Please re-enter them."
                            },
                            {
                                "value": "PinPrompt=Enter Pin:"
                            },
                            {
                                "value": "ConfirmPinPrompt=Confirm Pin:"
                            },
                            {
                                "value": "NoMatchPin=These pins do not match. Please re-enter them."
                            },
                            {
                                "value": "ErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\""
                            }
                        ],
                        "value": "ConvertFrom-StringData -stringdata @'"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "pipeline_id": "6",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "e3b8844b-d92a-4a0e-817f-c6291b380c70",
                    "sequence": 1,
                    "total": 1
                },
                "process": {
                    "args": [
                        "powershell",
                        "$admin_secpwd",
                        "=",
                        "ConvertTo-SecureString",
                        "'breach'",
                        "-AsPlainText",
                        "-Force;",
                        "$credential",
                        "=",
                        "New-Object",
                        "-TypeName",
                        "System.Management.Automation.PSCredential",
                        "-ArgumentList",
                        "'BREACH\\Administrator',",
                        "$admin_secpwd;",
                        "Add-Computer",
                        "-Credential",
                        "$credential",
                        "-DomainName",
                        "'BREACH'",
                        "-Restart",
                        "-Force"
                    ],
                    "args_count": 22,
                    "command_line": "powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force",
                    "entity_id": "5a4c00e4-9e12-44d8-b381-e05e1c79ca23",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "setup"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "setup"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Windows PowerShell",
                    "computer_name": "CLIENT1",
                    "event_id": 800,
                    "keywords": [
                        "Classic"
                    ],
                    "opcode": "Info",
                    "provider_name": "PowerShell",
                    "record_id": 6582,
                    "task": "Pipeline Execution Details"
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:57:51.754+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:57:51.766Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Executing Pipeline",
                    "category": [
                        "process"
                    ],
                    "code": 4103,
                    "created": "2022-10-10T10:00:26.625Z",
                    "kind": "event",
                    "module": "powershell",
                    "provider": "Microsoft-Windows-PowerShell",
                    "sequence": 18,
                    "type": [
                        "info"
                    ]
                },
                "file": {
                    "directory": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US",
                    "extension": "psd1",
                    "name": "BitLocker.psd1",
                    "path": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1"
                },
                "host": {
                    "name": "CLIENT1"
                },
                "log": {
                    "level": "information"
                },
                "message": "CommandInvocation(ConvertFrom-StringData): \"ConvertFrom-StringData\"\nParameterBinding(ConvertFrom-StringData): name=\"StringData\"; value=\"###PSLOC\nErrorMountPointNotFound={0} does not have an associated BitLocker volume.\nErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume.\nErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume.\nErrorOperatingSystemMountPointNotFound=An operating system volume could not be found.\nWarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly.\nErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM.\nWarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.\nWarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)\nWarningHardwareTestFailed=ERROR: The hardware test failed with code 0x        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = 5a4c00e4-9e12-44d8-b381-e05e1c79ca23\n        Host Application = powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force\n        Engine Version = 5.1.19041.1237\n        Runspace ID = e3b8844b-d92a-4a0e-817f-c6291b380c70\n        Pipeline ID = 6\n        Command Name = ConvertFrom-StringData\n        Command Type = Cmdlet\n        Script Name = C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1\n        Command Path = \n        Sequence Number = 18\n        User = CLIENT1\\setup\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}\nWarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nWarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)\nErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery.\nErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in.\nErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller.\nPasswordPrompt=Enter Password:\nConfirmPasswordPrompt=Confirm Password:\nNoMatchPassword=These passwords do not match. Please re-enter them.\nPinPrompt=Enter Pin:\nConfirmPinPrompt=Confirm Pin:\nNoMatchPin=These pins do not match. Please re-enter them.\nErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = 5a4c00e4-9e12-44d8-b381-e05e1c79ca23\n        Host Application = powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force\n        Engine Version = 5.1.19041.1237\n        Runspace ID = e3b8844b-d92a-4a0e-817f-c6291b380c70\n        Pipeline ID = 6\n        Command Name = ConvertFrom-StringData\n        Command Type = Cmdlet\n        Script Name = C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\BitLocker\\en-US\\BitLocker.psd1\n        Command Path = \n        Sequence Number = 18\n        User = CLIENT1\\setup\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:",
                "powershell": {
                    "command": {
                        "invocation_details": [
                            {
                                "related_command": "ConvertFrom-StringData",
                                "type": "CommandInvocation",
                                "value": "\"ConvertFrom-StringData\""
                            },
                            {
                                "name": "\"StringData\"",
                                "related_command": "ConvertFrom-StringData",
                                "type": "ParameterBinding",
                                "value": "\"###PSLOC"
                            },
                            {
                                "value": "ErrorMountPointNotFound={0} does not have an associated BitLocker volume."
                            },
                            {
                                "value": "ErrorVolumeNotFound=Device Id: {0} does not have a corresponding volume."
                            },
                            {
                                "value": "ErrorVolumeBoundAlready=This key protector cannot be deleted because it is being used to automatically unlock the volume."
                            },
                            {
                                "value": "ErrorOperatingSystemMountPointNotFound=An operating system volume could not be found."
                            },
                            {
                                "value": "WarningUsedSpaceOnlyAndHardwareEncryption=UsedSpaceOnly switch and HardwareEncryption switch cannot be used together. Ignoring UsedSpaceOnly."
                            },
                            {
                                "value": "ErrorExternalKeyOrPasswordRequired=An external key or password protector is required to enable BitLocker on an operating system volume without a valid TPM."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPassword=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume."
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordInsertExternalKeyRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2.Insert a USB flash drive with an external key file into the computer.{1}3. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningWriteDownRecoveryPasswordRestart=ACTIONS REQUIRED:{1}{1}1. Save this numerical recovery password in a secure location away from your computer:{1}{1}{0}{1}{1}To prevent data loss, save this password immediately. This password helps ensure that you can unlock the encrypted volume.{1}2. Restart the computer to run a hardware test.{1}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningHardwareTestFailed=ERROR: The hardware test failed with code 0x%1!08x!. All key protectors{0}were removed.{0}{0}Possible reasons that the hardware test failed are:{0}{0}1. A USB flash drive with an external key file was not found.{0}{0}- Insert a USB flash drive with an external key file into the computer.{0}- If this failure persists, the computer cannot read USB drives{0}during boot. You may not be able to use external keys to unlock{0}the OS volume during boot.{0}{0}2. The external key file on the USB flash drive was corrupt.{0}{0}- Try a different USB flash drive to store the external key file.{0}{0}3. The TPM is off.{0}{0}- To manage the Trusted Platform Module (TPM), use either the{0}TPM Management MMC snap-in or the TPM Management PowerShell cmdlets.{0}{0}4. The TPM detected a change in OS boot components.{0}{0}- Remove any bootable CD or DVD from the computer.{0}- If this failure persists, check that the latest firmware and BIOS{0}upgrades are installed, and that the TPM is otherwise working properly.{0}{0}5. The provided PIN was incorrect.{0}{0}6. The TPM storage root key (SRK) has an incompatible authorization value.{0}{0}- To reset this value, run the TPM Initialization Wizard.{0}{0}ACTIONS REQUIRED:{0}{0}1. Resolve the hardware test failure above.{0}2. Re-run the command to turn on BitLocker.{0}"
                            },
                            {
                                "value": "WarningInsertExternalKeyRestart=ACTIONS REQUIRED:{0}{0}1.Insert a USB flash drive with an external key file into the computer.{0}2. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "WarningRestart=ACTIONS REQUIRED:{0}{0}1. Restart the computer to run a hardware test.{0}    (Type: get-help Restart-Computer for command line instructions.)"
                            },
                            {
                                "value": "ErrorSidProtectorRequiresAdditionalRecoveryProtector=To turn on BitLocker with a SID-based Identity protector on this volume, you must provide at least one additional protector for recovery."
                            },
                            {
                                "value": "ErrorRemoveDraProtector=Removal of the data recovery agent certificate must be done using the Certificates snap-in."
                            },
                            {
                                "value": "ErrorRemoveNkpProtector=Network Unlock can only be disabled within the BitLocker Drive Encryption group policy setting \"Allow network unlock at startup\", or by removing the Public Key Policies group policy setting \"BitLocker Drive Encryption Network Unlock Certificate\" on the domain controller."
                            },
                            {
                                "value": "PasswordPrompt=Enter Password:"
                            },
                            {
                                "value": "ConfirmPasswordPrompt=Confirm Password:"
                            },
                            {
                                "value": "NoMatchPassword=These passwords do not match. Please re-enter them."
                            },
                            {
                                "value": "PinPrompt=Enter Pin:"
                            },
                            {
                                "value": "ConfirmPinPrompt=Confirm Pin:"
                            },
                            {
                                "value": "NoMatchPin=These pins do not match. Please re-enter them."
                            },
                            {
                                "value": "ErrorGroupPolicyDisabledBackup=Group policy does not permit the storage of recovery information to Active Directory. The operation was not attempted.\""
                            }
                        ],
                        "name": "ConvertFrom-StringData",
                        "type": "Cmdlet"
                    },
                    "engine": {
                        "version": "5.1.19041.1237"
                    },
                    "id": "Microsoft.PowerShell",
                    "pipeline_id": "6",
                    "process": {
                        "executable_version": "5.1.19041.1237"
                    },
                    "runspace_id": "e3b8844b-d92a-4a0e-817f-c6291b380c70"
                },
                "process": {
                    "args": [
                        "powershell",
                        "$admin_secpwd",
                        "=",
                        "ConvertTo-SecureString",
                        "'breach'",
                        "-AsPlainText",
                        "-Force;",
                        "$credential",
                        "=",
                        "New-Object",
                        "-TypeName",
                        "System.Management.Automation.PSCredential",
                        "-ArgumentList",
                        "'BREACH\\Administrator',",
                        "$admin_secpwd;",
                        "Add-Computer",
                        "-Credential",
                        "$credential",
                        "-DomainName",
                        "'BREACH'",
                        "-Restart",
                        "-Force"
                    ],
                    "args_count": 22,
                    "command_line": "powershell $admin_secpwd = ConvertTo-SecureString 'breach' -AsPlainText -Force; $credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList 'BREACH\\Administrator', $admin_secpwd; Add-Computer -Credential $credential -DomainName 'BREACH' -Restart -Force",
                    "entity_id": "5a4c00e4-9e12-44d8-b381-e05e1c79ca23",
                    "title": "ConsoleHost"
                },
                "related": {
                    "user": "setup"
                },
                "user": {
                    "domain": "CLIENT1",
                    "name": "setup"
                },
                "winlog": {
                    "activity_id": "{b0c2654b-dc8e-0000-d669-c2b08edcd801}",
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-PowerShell/Operational",
                    "computer_name": "CLIENT1",
                    "event_id": 4103,
                    "opcode": "To be used when operation is just executing a method",
                    "process": {
                        "pid": 4380,
                        "thread": {
                            "id": 4524
                        }
                    },
                    "provider_guid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}",
                    "provider_name": "Microsoft-Windows-PowerShell",
                    "record_id": 6047,
                    "task": "Executing Pipeline",
                    "user": {
                        "domain": "CLIENT1",
                        "identifier": "S-1-5-21-2755423373-3250654863-1302750906-1002",
                        "name": "setup",
                        "type": "User"
                    },
                    "version": 1
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:57:51.766+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:58:33.468Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.932Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs",
                    "name": "Windows PowerShell",
                    "path": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:58:33.468\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\nCreationUtcTime: 2022-10-10 09:58:33.468\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:58:33.468",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 1298,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:58:33.468+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:58:33.517Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.932Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{d8aadefb-68d4-402f-8412-cfe6233456ba}.tmp",
                    "path": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d8aadefb-68d4-402f-8412-cfe6233456ba}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:58:33.517\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d8aadefb-68d4-402f-8412-cfe6233456ba}.tmp\nCreationUtcTime: 2022-10-10 09:58:33.497\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:58:33.497",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 1303,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:58:33.517+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:58:33.517Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.932Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{d8aadefb-68d4-402f-8412-cfe6233456ba}.tmp",
                    "path": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d8aadefb-68d4-402f-8412-cfe6233456ba}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:58:33.517\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d8aadefb-68d4-402f-8412-cfe6233456ba}.tmp\nCreationUtcTime: 2022-10-10 09:58:33.497\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:58:33.497",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 1304,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:58:33.517+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:58:33.517Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.933Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{afa8a713-3653-499e-820e-5499c457eb1b}.tmp",
                    "path": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{afa8a713-3653-499e-820e-5499c457eb1b}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:58:33.517\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{afa8a713-3653-499e-820e-5499c457eb1b}.tmp\nCreationUtcTime: 2022-10-10 09:58:33.517\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:58:33.517",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 1305,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:58:33.517+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:58:33.530Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T10:00:27.933Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{afa8a713-3653-499e-820e-5499c457eb1b}.tmp",
                    "path": "C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{afa8a713-3653-499e-820e-5499c457eb1b}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 09:58:33.530\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\client1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{afa8a713-3653-499e-820e-5499c457eb1b}.tmp\nCreationUtcTime: 2022-10-10 09:58:33.517\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 09:58:33.517",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 1307,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T09:58:33.530+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:17:50.235Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T11:17:51.466Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs",
                    "name": "Windows PowerShell",
                    "path": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 11:17:50.235\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\nCreationUtcTime: 2022-10-10 11:17:50.235\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 11:17:50.235",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9160,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T11:17:50.235+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:17:50.270Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T11:17:51.466Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{61f87449-6df8-49a6-b0dd-471998db356e}.tmp",
                    "path": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{61f87449-6df8-49a6-b0dd-471998db356e}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 11:17:50.270\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{61f87449-6df8-49a6-b0dd-471998db356e}.tmp\nCreationUtcTime: 2022-10-10 11:17:50.270\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 11:17:50.270",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9165,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T11:17:50.270+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:17:50.270Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T11:17:51.467Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{d7789c6d-e219-4d64-807c-71eead5e4349}.tmp",
                    "path": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d7789c6d-e219-4d64-807c-71eead5e4349}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 11:17:50.270\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d7789c6d-e219-4d64-807c-71eead5e4349}.tmp\nCreationUtcTime: 2022-10-10 11:17:50.270\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 11:17:50.270",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9168,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T11:17:50.270+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:17:50.270Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T11:17:51.467Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{d7789c6d-e219-4d64-807c-71eead5e4349}.tmp",
                    "path": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d7789c6d-e219-4d64-807c-71eead5e4349}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 11:17:50.270\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{d7789c6d-e219-4d64-807c-71eead5e4349}.tmp\nCreationUtcTime: 2022-10-10 11:17:50.270\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 11:17:50.270",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9166,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T11:17:50.270+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:17:50.270Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T11:17:51.467Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell",
                    "extension": "tmp",
                    "name": "{61f87449-6df8-49a6-b0dd-471998db356e}.tmp",
                    "path": "C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{61f87449-6df8-49a6-b0dd-471998db356e}.tmp"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: T1023\nUtcTime: 2022-10-10 11:17:50.270\nProcessGuid: {0e37ca90-ecbf-6343-1300-000000000500}\nProcessId: 400\nImage: C:\\Windows\\system32\\svchost.exe\nTargetFilename: C:\\Users\\ssh\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Windows PowerShell\\{61f87449-6df8-49a6-b0dd-471998db356e}.tmp\nCreationUtcTime: 2022-10-10 11:17:50.270\nUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "entity_id": "{0e37ca90-ecbf-6343-1300-000000000500}",
                    "executable": "C:\\Windows\\system32\\svchost.exe",
                    "name": "svchost.exe",
                    "pid": 400
                },
                "rule": {
                    "name": "T1023"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 11:17:50.270",
                        "User": "NT AUTHORITY\\SYSTEM"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9167,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T11:17:50.270+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:17:51.182Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "File created (rule: FileCreate)",
                    "category": [
                        "file"
                    ],
                    "code": 11,
                    "created": "2022-10-10T11:17:52.475Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "creation"
                    ]
                },
                "file": {
                    "directory": "C:\\Users\\ssh\\AppData\\Local\\Microsoft\\CLR_v4.0\\UsageLogs",
                    "extension": "log",
                    "name": "powershell.exe.log",
                    "path": "C:\\Users\\ssh\\AppData\\Local\\Microsoft\\CLR_v4.0\\UsageLogs\\powershell.exe.log"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "File created:\nRuleName: ProcessHostingdotNETCode\nUtcTime: 2022-10-10 11:17:51.182\nProcessGuid: {0e37ca90-ff5e-6343-fb11-000000000500}\nProcessId: 4368\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nTargetFilename: C:\\Users\\ssh\\AppData\\Local\\Microsoft\\CLR_v4.0\\UsageLogs\\powershell.exe.log\nCreationUtcTime: 2022-10-10 11:17:51.182\nUser: CLIENT1\\ssh",
                "process": {
                    "entity_id": "{0e37ca90-ff5e-6343-fb11-000000000500}",
                    "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "name": "powershell.exe",
                    "pid": 4368
                },
                "rule": {
                    "name": "ProcessHostingdotNETCode"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "CreationUtcTime": "2022-10-10 11:17:51.182",
                        "User": "CLIENT1\\ssh"
                    },
                    "event_id": 11,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9205,
                    "task": "File created (rule: FileCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 2
                }
            }
        },
        "name": "PowerShell Scripts Run by a Services",
        "timestamp": "2022-10-10T11:17:51.182+00:00",
        "authors": [
            "oscd.community",
            "Natalia Shornikova"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "46deb5e1-28c9-4905-b2df-51cdcc9e6073",
        "logsource": {
            "category": "driver_load",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "tags": [
            "attack.execution",
            "attack.t1569.002"
        ]
    },
    {
        "total_hits": 21
    }
]