[
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T11:14:08.480Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Process Create (rule: ProcessCreate)",
                    "category": [
                        "process"
                    ],
                    "code": 1,
                    "created": "2022-10-10T11:14:09.529Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "start",
                        "process_start"
                    ]
                },
                "hash": {
                    "imphash": "272245e2988e1e430500b852c4fb5e18",
                    "md5": "8a2122e8162dbef04694b9c3e0b6cdee",
                    "sha256": "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Process Create:\nRuleName: -\nUtcTime: 2022-10-10 11:14:08.480\nProcessGuid: {0e37ca90-fe80-6343-ee11-000000000500}\nProcessId: 4640\nImage: C:\\Windows\\System32\\cmd.exe\nFileVersion: 10.0.19041.746 (WinBuild.160101.0800)\nDescription: Windows Command Processor\nProduct: Microsoft速 Windows速 Operating System\nCompany: Microsoft Corporation\nOriginalFileName: Cmd.Exe\nCommandLine: cmd.exe /c echo fxpqtf > \\\\.\\pipe\\fxpqtf\nCurrentDirectory: C:\\Windows\\system32\\\nUser: NT AUTHORITY\\SYSTEM\nLogonGuid: {0e37ca90-ecbe-6343-e703-000000000000}\nLogonId: 0x3E7\nTerminalSessionId: 0\nIntegrityLevel: System\nHashes: MD5=8A2122E8162DBEF04694B9C3E0B6CDEE,SHA256=B99D61D874728EDC0918CA0EB10EAB93D381E7367E377406E65963366C874450,IMPHASH=272245E2988E1E430500B852C4FB5E18\nParentProcessGuid: {0e37ca90-ecbe-6343-0b00-000000000500}\nParentProcessId: 592\nParentImage: C:\\Windows\\System32\\services.exe\nParentCommandLine: C:\\Windows\\system32\\services.exe\nParentUser: NT AUTHORITY\\SYSTEM",
                "process": {
                    "args": [
                        "cmd.exe",
                        "/c",
                        "echo",
                        "fxpqtf",
                        ">",
                        "\\\\.\\pipe\\fxpqtf"
                    ],
                    "command_line": "cmd.exe /c echo fxpqtf > \\\\.\\pipe\\fxpqtf",
                    "entity_id": "{0e37ca90-fe80-6343-ee11-000000000500}",
                    "executable": "C:\\Windows\\System32\\cmd.exe",
                    "hash": {
                        "md5": "8a2122e8162dbef04694b9c3e0b6cdee",
                        "sha256": "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
                    },
                    "name": "cmd.exe",
                    "parent": {
                        "args": [
                            "C:\\Windows\\system32\\services.exe"
                        ],
                        "command_line": "C:\\Windows\\system32\\services.exe",
                        "entity_id": "{0e37ca90-ecbe-6343-0b00-000000000500}",
                        "executable": "C:\\Windows\\System32\\services.exe",
                        "name": "services.exe",
                        "pid": 592
                    },
                    "pe": {
                        "imphash": "272245e2988e1e430500b852c4fb5e18"
                    },
                    "pid": 4640,
                    "working_directory": "C:\\Windows\\system32\\"
                },
                "related": {
                    "hash": [
                        "8a2122e8162dbef04694b9c3e0b6cdee",
                        "b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                        "272245e2988e1e430500b852c4fb5e18"
                    ],
                    "user": "SYSTEM"
                },
                "user": {
                    "domain": "NT AUTHORITY",
                    "name": "SYSTEM"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "Company": "Microsoft Corporation",
                        "Description": "Windows Command Processor",
                        "FileVersion": "10.0.19041.746 (WinBuild.160101.0800)",
                        "IntegrityLevel": "System",
                        "LogonGuid": "{0e37ca90-ecbe-6343-e703-000000000000}",
                        "LogonId": "0x3e7",
                        "OriginalFileName": "Cmd.Exe",
                        "ParentUser": "NT AUTHORITY\\SYSTEM",
                        "Product": "Microsoft速 Windows速 Operating System",
                        "RuleName": "-",
                        "TerminalSessionId": "0"
                    },
                    "event_id": 1,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 9109,
                    "task": "Process Create (rule: ProcessCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 5
                }
            }
        },
        "name": "Meterpreter or Cobalt Strike Getsystem Service Start",
        "timestamp": "2022-10-10T11:14:08.480+00:00",
        "authors": [
            "Teymur Kheirkhabarov",
            "Ecco",
            "Florian Roth"
        ],
        "level": "high",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Commandlines containing components like cmd accidentally",
            "Jobs and services started with cmd"
        ],
        "id": "15619216-e993-4721-b590-4c520615a67d",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
            "https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/"
        ],
        "tags": [
            "attack.privilege_escalation",
            "attack.t1134.001",
            "attack.t1134.002"
        ]
    },
    {
        "total_hits": 1
    }
]