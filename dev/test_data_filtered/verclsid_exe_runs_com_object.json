[
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:57:05.634Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Process Create (rule: ProcessCreate)",
                    "category": [
                        "process"
                    ],
                    "code": 1,
                    "created": "2022-10-10T10:00:27.371Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "start",
                        "process_start"
                    ]
                },
                "hash": {
                    "imphash": "fa65d753209c7382631265744de49154",
                    "md5": "81d41e225b8b55748ffb0d8747fe8bac",
                    "sha256": "ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d"
                },
                "host": {
                    "name": "CLIENT"
                },
                "log": {
                    "level": "information"
                },
                "message": "Process Create:\nRuleName: -\nUtcTime: 2022-10-10 09:57:05.634\nProcessGuid: {0e37ca90-ec71-6343-9e00-000000000300}\nProcessId: 2756\nImage: C:\\Windows\\System32\\verclsid.exe\nFileVersion: 10.0.19041.1 (WinBuild.160101.0800)\nDescription: Extension CLSID Verification Host\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: verclsid.exe\nCommandLine: \"C:\\Windows\\system32\\verclsid.exe\" /S /C {9E175B8B-F52A-11D8-B9A5-505054503030} /I {0C733A8A-2A1C-11CE-ADE5-00AA0044773D} /X 0x401\nCurrentDirectory: C:\\Windows\\system32\\\nUser: CLIENT\\setup\nLogonGuid: {0e37ca90-ec39-6343-6526-030000000000}\nLogonId: 0x32665\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: MD5=81D41E225B8B55748FFB0D8747FE8BAC,SHA256=AC6E1F614CB902C0ABE4297646E21C70590624B652A080BFBB8407B1AB52609D,IMPHASH=FA65D753209C7382631265744DE49154\nParentProcessGuid: {0e37ca90-ec6e-6343-9c00-000000000300}\nParentProcessId: 3636\nParentImage: C:\\Windows\\System32\\RuntimeBroker.exe\nParentCommandLine: C:\\Windows\\System32\\RuntimeBroker.exe -Embedding\nParentUser: CLIENT\\setup",
                "process": {
                    "args": [
                        "C:\\Windows\\system32\\verclsid.exe",
                        "/S",
                        "/C",
                        "{9E175B8B-F52A-11D8-B9A5-505054503030}",
                        "/I",
                        "{0C733A8A-2A1C-11CE-ADE5-00AA0044773D}",
                        "/X",
                        "0x401"
                    ],
                    "command_line": "\"C:\\Windows\\system32\\verclsid.exe\" /S /C {9E175B8B-F52A-11D8-B9A5-505054503030} /I {0C733A8A-2A1C-11CE-ADE5-00AA0044773D} /X 0x401",
                    "entity_id": "{0e37ca90-ec71-6343-9e00-000000000300}",
                    "executable": "C:\\Windows\\System32\\verclsid.exe",
                    "hash": {
                        "md5": "81d41e225b8b55748ffb0d8747fe8bac",
                        "sha256": "ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d"
                    },
                    "name": "verclsid.exe",
                    "parent": {
                        "args": [
                            "C:\\Windows\\System32\\RuntimeBroker.exe",
                            "-Embedding"
                        ],
                        "command_line": "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding",
                        "entity_id": "{0e37ca90-ec6e-6343-9c00-000000000300}",
                        "executable": "C:\\Windows\\System32\\RuntimeBroker.exe",
                        "name": "RuntimeBroker.exe",
                        "pid": 3636
                    },
                    "pe": {
                        "imphash": "fa65d753209c7382631265744de49154"
                    },
                    "pid": 2756,
                    "working_directory": "C:\\Windows\\system32\\"
                },
                "related": {
                    "hash": [
                        "81d41e225b8b55748ffb0d8747fe8bac",
                        "ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d",
                        "fa65d753209c7382631265744de49154"
                    ],
                    "user": "setup"
                },
                "user": {
                    "domain": "CLIENT",
                    "name": "setup"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT",
                    "event_data": {
                        "Company": "Microsoft Corporation",
                        "Description": "Extension CLSID Verification Host",
                        "FileVersion": "10.0.19041.1 (WinBuild.160101.0800)",
                        "IntegrityLevel": "High",
                        "LogonGuid": "{0e37ca90-ec39-6343-6526-030000000000}",
                        "LogonId": "0x32665",
                        "OriginalFileName": "verclsid.exe",
                        "ParentUser": "CLIENT\\setup",
                        "Product": "Microsoft® Windows® Operating System",
                        "RuleName": "-",
                        "TerminalSessionId": "1"
                    },
                    "event_id": 1,
                    "opcode": "Info",
                    "process": {
                        "pid": 1904,
                        "thread": {
                            "id": 2536
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 791,
                    "task": "Process Create (rule: ProcessCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 5
                }
            }
        },
        "name": "Verclsid.exe Runs COM Object",
        "timestamp": "2022-10-10T09:57:05.634+00:00",
        "authors": [
            "Victor Sergeev",
            "oscd.community"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "d06be4b9-8045-428b-a567-740a26d9db25",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://lolbas-project.github.io/lolbas/Binaries/Verclsid/",
            "https://gist.github.com/NickTyrer/0598b60112eaafe6d07789f7964290d5",
            "https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/"
        ],
        "tags": [
            "attack.defense_evasion",
            "attack.t1218"
        ]
    },
    {
        "group": "Sigma",
        "kind": "individual",
        "document": {
            "kind": "jsonl",
            "data": {
                "@timestamp": "2022-10-10T09:59:08.000Z",
                "agent": {
                    "ephemeral_id": "64b72b79-c8b3-44d5-8efc-41706d768842",
                    "hostname": "CLIENT1",
                    "id": "cd699c72-0f46-4cd9-938a-43faf035a44a",
                    "name": "CLIENT1",
                    "type": "winlogbeat",
                    "version": "7.10.2"
                },
                "ecs": {
                    "version": "1.5.0"
                },
                "event": {
                    "action": "Process Create (rule: ProcessCreate)",
                    "category": [
                        "process"
                    ],
                    "code": 1,
                    "created": "2022-10-10T10:00:28.225Z",
                    "kind": "event",
                    "module": "sysmon",
                    "provider": "Microsoft-Windows-Sysmon",
                    "type": [
                        "start",
                        "process_start"
                    ]
                },
                "hash": {
                    "imphash": "fa65d753209c7382631265744de49154",
                    "md5": "81d41e225b8b55748ffb0d8747fe8bac",
                    "sha256": "ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d"
                },
                "host": {
                    "name": "CLIENT1.breach.local"
                },
                "log": {
                    "level": "information"
                },
                "message": "Process Create:\nRuleName: -\nUtcTime: 2022-10-10 09:59:08.000\nProcessGuid: {0e37ca90-ecec-6343-8100-000000000500}\nProcessId: 6124\nImage: C:\\Windows\\System32\\verclsid.exe\nFileVersion: 10.0.19041.1 (WinBuild.160101.0800)\nDescription: Extension CLSID Verification Host\nProduct: Microsoft® Windows® Operating System\nCompany: Microsoft Corporation\nOriginalFileName: verclsid.exe\nCommandLine: \"C:\\Windows\\system32\\verclsid.exe\" /S /C {9E175B8B-F52A-11D8-B9A5-505054503030} /I {0C733A8A-2A1C-11CE-ADE5-00AA0044773D} /X 0x401\nCurrentDirectory: C:\\Windows\\system32\\\nUser: BREACH\\client1\nLogonGuid: {0e37ca90-ecc9-6343-2f4b-040000000000}\nLogonId: 0x44B2F\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: MD5=81D41E225B8B55748FFB0D8747FE8BAC,SHA256=AC6E1F614CB902C0ABE4297646E21C70590624B652A080BFBB8407B1AB52609D,IMPHASH=FA65D753209C7382631265744DE49154\nParentProcessGuid: {0e37ca90-ecea-6343-7f00-000000000500}\nParentProcessId: 5984\nParentImage: C:\\Windows\\System32\\RuntimeBroker.exe\nParentCommandLine: C:\\Windows\\System32\\RuntimeBroker.exe -Embedding\nParentUser: BREACH\\client1",
                "process": {
                    "args": [
                        "C:\\Windows\\system32\\verclsid.exe",
                        "/S",
                        "/C",
                        "{9E175B8B-F52A-11D8-B9A5-505054503030}",
                        "/I",
                        "{0C733A8A-2A1C-11CE-ADE5-00AA0044773D}",
                        "/X",
                        "0x401"
                    ],
                    "command_line": "\"C:\\Windows\\system32\\verclsid.exe\" /S /C {9E175B8B-F52A-11D8-B9A5-505054503030} /I {0C733A8A-2A1C-11CE-ADE5-00AA0044773D} /X 0x401",
                    "entity_id": "{0e37ca90-ecec-6343-8100-000000000500}",
                    "executable": "C:\\Windows\\System32\\verclsid.exe",
                    "hash": {
                        "md5": "81d41e225b8b55748ffb0d8747fe8bac",
                        "sha256": "ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d"
                    },
                    "name": "verclsid.exe",
                    "parent": {
                        "args": [
                            "C:\\Windows\\System32\\RuntimeBroker.exe",
                            "-Embedding"
                        ],
                        "command_line": "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding",
                        "entity_id": "{0e37ca90-ecea-6343-7f00-000000000500}",
                        "executable": "C:\\Windows\\System32\\RuntimeBroker.exe",
                        "name": "RuntimeBroker.exe",
                        "pid": 5984
                    },
                    "pe": {
                        "imphash": "fa65d753209c7382631265744de49154"
                    },
                    "pid": 6124,
                    "working_directory": "C:\\Windows\\system32\\"
                },
                "related": {
                    "hash": [
                        "81d41e225b8b55748ffb0d8747fe8bac",
                        "ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d",
                        "fa65d753209c7382631265744de49154"
                    ],
                    "user": "client1"
                },
                "user": {
                    "domain": "BREACH",
                    "name": "client1"
                },
                "winlog": {
                    "api": "wineventlog",
                    "channel": "Microsoft-Windows-Sysmon/Operational",
                    "computer_name": "CLIENT1.breach.local",
                    "event_data": {
                        "Company": "Microsoft Corporation",
                        "Description": "Extension CLSID Verification Host",
                        "FileVersion": "10.0.19041.1 (WinBuild.160101.0800)",
                        "IntegrityLevel": "High",
                        "LogonGuid": "{0e37ca90-ecc9-6343-2f4b-040000000000}",
                        "LogonId": "0x44b2f",
                        "OriginalFileName": "verclsid.exe",
                        "ParentUser": "BREACH\\client1",
                        "Product": "Microsoft® Windows® Operating System",
                        "RuleName": "-",
                        "TerminalSessionId": "1"
                    },
                    "event_id": 1,
                    "opcode": "Info",
                    "process": {
                        "pid": 1160,
                        "thread": {
                            "id": 2496
                        }
                    },
                    "provider_guid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                    "provider_name": "Microsoft-Windows-Sysmon",
                    "record_id": 1454,
                    "task": "Process Create (rule: ProcessCreate)",
                    "user": {
                        "domain": "NT AUTHORITY",
                        "identifier": "S-1-5-18",
                        "name": "SYSTEM",
                        "type": "User"
                    },
                    "version": 5
                }
            }
        },
        "name": "Verclsid.exe Runs COM Object",
        "timestamp": "2022-10-10T09:59:08+00:00",
        "authors": [
            "Victor Sergeev",
            "oscd.community"
        ],
        "level": "medium",
        "source": "sigma",
        "status": "experimental",
        "falsepositives": [
            "Unknown"
        ],
        "id": "d06be4b9-8045-428b-a567-740a26d9db25",
        "logsource": {
            "category": "process_creation",
            "product": "windows"
        },
        "references": [
            "https://lolbas-project.github.io/lolbas/Binaries/Verclsid/",
            "https://gist.github.com/NickTyrer/0598b60112eaafe6d07789f7964290d5",
            "https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/"
        ],
        "tags": [
            "attack.defense_evasion",
            "attack.t1218"
        ]
    },
    {
        "total_hits": 2
    }
]